<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1.0, maximum-scale=2.0">

<title>Valid Data Table</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css"
	href="resources/syntax/shCore.css">
<link rel="stylesheet" type="text/css" href="resources/demo.css">
<link rel="stylesheet" href="media/css/bootstrap-table.css">
<style type="text/css" class="init">
</style>
<script type="text/javascript" language="javascript"
	src="media/js/jquery.js"></script>
<script type="text/javascript" language="javascript"
	src="resources/syntax/shCore.js"></script>
<script type="text/javascript" language="javascript"
	src="resources/demo.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="media/js/bootstrap-table.js"></script>
<script type="text/javascript" src="media/js/jquery.tablesorter.js"></script>
<script type="text/javascript" language="javascript" class="init">
	
</script>
</head>

<body>
	<h4>
		<a href='http://localhost:8080/CallFailureEnterprise/upload.html'>Go
			back to upload page</a>
	</h4>
	<p>
	<h2>Query Results</h2>
	<br/>
	<label for="title">Query address:</label>
	<input type="text" class="form-control" id="title">
	<br/>
	<table id="dataTable" class="table tablesorter tablesorter-default table-striped table-bordered">
		
	</table>
	<button id="query1" type="button" class="btn btn-primary">Query 1</button>
	<script>
		$(document).ready(function() {
			$(function() {
				$("#dataTable").tablesorter();
			});
		});

		 $("#query1").click(function getData() {
			$.ajax({
				type : 'GET',
				url : $("#title").val(),
				success : function(data){
					
					var columnTitles=[];
					for(j=0;j<data.dataCollection[0].length;j++){
						columnTitles.push({
								title: ""+data.dataCollection[0][j],
								field: ""+data.dataCollection[0][j],
		                        align: 'center',
		                        valign: 'middle',
		                        sortable: true
						});
					}
					
					$('#dataTable').bootstrapTable({			
			            columns: columnTitles
			        });

					var arr=[];
					for(i=1;i<data.dataCollection.length;i++){
						var rowData='{';
						for(j=0;j<data.dataCollection[i].length-1;j++){
							rowData+='"'+data.dataCollection[0][j]+'" : "'+data.dataCollection[i][j]+'",';
						}
						rowData+='"'+data.dataCollection[0][data.dataCollection[i].length-1]+'" : "'+data.dataCollection[i][data.dataCollection[i].length-1]+'"';
						rowData+='}';
						arr.push(JSON.parse(rowData));
					}
					$('#dataTable').bootstrapTable('load', arr);
					$("#dataTable").trigger("update");
				},
			});
			
		});
	</script>
</body>
</html>